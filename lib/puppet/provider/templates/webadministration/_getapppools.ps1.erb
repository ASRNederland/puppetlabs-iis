# TODO: this is JSON, PS v2 doesnt support it
# PSCustomObject isnt present in v2
Get-WebConfiguration -Filter '/system.applicationHost/applicationPools/add' | % {
  [PSCustomObject]@{
    name  = [string]$_.Name
    state = [string]$_.State
    managedpipelinemode = [string]$_.ManagedPipelineMode
    managedruntimeversion = [string]$_.ManagedRuntimeVersion
  }
} | ConvertTo-Json -Depth 10
