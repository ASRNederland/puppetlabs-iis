Get-WebConfiguration -Filter '/system.applicationHost/applicationPools/add' | % {
  New-Object -TypeName PSObject -Property @{
    name  = [string]$_.Name
    state = [string]$_.State
    managedpipelinemode = [string]$_.ManagedPipelineMode
    managedruntimeversion = [string]$_.ManagedRuntimeVersion
  }
} | ConvertTo-Json -Depth 10
